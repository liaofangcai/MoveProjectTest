// Generated by CoffeeScript 1.8.0
(function() {
  define(['cdeio/core/feature', 'cdeio/core/resource-loader', 'cdeio/core/config'], function(Feature, loadResource, config) {
    return {
      type: 'feature',
      name: 'cdeio',
      fn: function(module, feature, featureName, args) {
        var cdeio, deferred, options;
        options = args[0];
        deferred = $.Deferred();
        cdeio = module.getApplication().findModule('cdeio-features');
        if (!cdeio) {
          cdeio = module.getApplication().module('cdeio-features');
          cdeio.paths = ['cdeio/features'];
          cdeio.initRouters();
        }
        cdeio.loadResource(featureName + '.feature/' + config.featureFileName).done(function(def) {
          if (def === null) {
            return deferred.resolve(null);
          }
          def.baseName = featureName;
          def.module = cdeio;
          feature = new Feature(def, options);
          return deferred.resolve(feature);
        });
        return deferred;
      }
    };
  });

}).call(this);

// Generated by CoffeeScript 1.8.0
(function() {
  define(['underscore', 'cdeio/core/layout', 'cdeio/core/config', 'cdeio/core/util'], function(_, Layout, config, util) {
    var error, getPath;
    getPath = config.getPath;
    error = util.error;
    return {
      type: 'layout',
      name: 'DEFAULT',
      fn: function(module, feature, layoutName, args) {
        var d, def, deferred;
        deferred = $.Deferred();
        d = args[0];
        if (_.isObject(d)) {
          def = _.extend(d, {
            baseName: layoutName || feature.baseName,
            el: feature.container,
            feature: feature,
            module: module
          });
          deferred.resolve(new Layout(def));
        } else {
          module.loadResource(getPath(feature, 'layout', layoutName)).done(function(def) {
            if (!def) {
              error(this, "No layout defined with name " + (getPath(this, 'layout', layoutName)) + ".");
            }
            def.el = feature.container;
            def.baseName = layoutName.charAt(0) === '/' ? layoutName.substring(1) : layoutName;
            def.feature = feature;
            def.module = module;
            return deferred.resolve(new Layout(def));
          });
        }
        return deferred.promise();
      }
    };
  });

}).call(this);
